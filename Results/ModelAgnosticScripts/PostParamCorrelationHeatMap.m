%Purpose:
%Parameter sets obtained from inference set, plot a correlation heat map

%2D grid array with colour intensity/shading per sector related to correlation between
%parameters
%--------------------------------------------------------------------------

function PostParamCorrelationHeatMap(PosteriorParams,AxesTickLabels,...
                                            FigSizeWidthScale,FigSizeHeightScale,...
                                            SaveFileName)
%Inputs:
%   PosteriorParams - (array, float) Particle sets generated by inference procedure
%   AxesTickLabels - (string) Parameter labels
%   FigSizeWidthScale,FigSizeHeightScale - (floats) Specify scaling of figure size
%   SaveFileName - (string) Specify location to save plots


%--------------------------------------------------------------------------
%%% CALCULATE CORRELATION COEFFICIENT
%--------------------------------------------------------------------------
%Call correlation coefficient function
%R -> matrix of correlation coefficients
%P -> matrix of p-values for testing the hypothesis that there is no relationship between the observed phenomena (null hypothesis)
% RL, RU - matrices containing lower and upper bounds for a 95% confidence interval for each coefficient
[R,P,RL,RU] = corrcoef(PosteriorParams)

%--------------------------------------------------------------------------
%%% PLOT HEAT MAP OF CORRELATION COEFFICIENTS
%--------------------------------------------------------------------------
%Set up figure
figure('Color',[1 1 1]);
clf
position = [10, 10, FigSizeWidthScale*550, FigSizeHeightScale*450];
set(0, 'DefaultFigurePosition', position);
hold on

%Generate heat map
colormap('hot');   % set colormap
imagesc(R);        % draw image and scale colormap to values range
cbar1 = colorbar;          % show color scale
caxis([-1 1])       %Set colourbar limits
cbar1.Label.String = 'Correlation coefficient'; % Add colourbar label
set(cbar1,'FontSize',20)

%Add axes lables
ParamNum = numel(AxesTickLabels); %Obtain number of Params from input data
xticks(1:ParamNum);
yticks(1:ParamNum);
xticklabels(AxesTickLabels)
yticklabels(AxesTickLabels)

%Alter axes labels orientiation
xtickangle(30)

%Alter y-axis direction
ax = gca;
ax.YDir = 'reverse';

%Remove axes tick marks (by reducing tick line length to zero!)
set(gca,'TickLength',[0 0])

%Set plot properties
set(gca,'Fontsize',15,'LineWidth',1);
box on

%%
%--------------------------------------------------------------------------
%%% SAVE FIGURE TO FILE - HOT COLOURMAP
%--------------------------------------------------------------------------
HotCMapSaveFileName = [SaveFileName,'_HotCMap'];
export_fig(HotCMapSaveFileName,'-pdf','-transparent','-painters','-r1200')
%--------------------------------------------------------------------------

%Alter colour map
colormap('gray');   % set colormap
imagesc(R);        % draw image and scale colormap to values range
cbar2 = colorbar;          % show color scale
caxis([-1 1])       %Set colourbar limits
cbar2.Label.String = 'Correlation coefficient'; % Add colourbar label
set(cbar2,'FontSize',20)

%%
%--------------------------------------------------------------------------
%%% SAVE FIGURE TO FILE - GRAY COLOURMAP
%--------------------------------------------------------------------------
HotCMapSaveFileName = [SaveFileName,'_GrayCMap'];
export_fig(HotCMapSaveFileName,'-pdf','-transparent','-painters','-r1200')


end
